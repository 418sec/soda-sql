name: Customers not having an email address
type: failures
sql: |

SELECT
    customer_id,
    ANY_VALUE(email_address) AS email_address,
    ANY_VALUE(
        CASE customer_type
        WHEN 'individual' THEN 'individual'
        WHEN 'business'   THEN 'business'
        ELSE 'unknown'
    END) AS customer_type
FROM database.customers
WHERE NOT email_address IS NULL
